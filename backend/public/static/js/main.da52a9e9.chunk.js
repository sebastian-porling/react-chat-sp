(this["webpackJsonpreact-chat"]=this["webpackJsonpreact-chat"]||[]).push([[0],{112:function(e,t,n){e.exports=n(163)},117:function(e,t,n){},127:function(e,t,n){},157:function(e,t){},160:function(e,t,n){},163:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(9),o=n.n(c),u=(n(117),n(207)),i=n(87),s=n(6),l=n.n(s),f=n(11),p=n(195),m=n(40);n(121),n(123);m.initializeApp({apiKey:"AIzaSyC-Tq6A86aG7exBpU97CPmsVrF89Sa6bMM",authDomain:"react-chat-2d594.firebaseapp.com",databaseURL:"https://react-chat-2d594.firebaseio.com",projectId:"react-chat-2d594",storageBucket:"react-chat-2d594.appspot.com",messagingSenderId:"58167961137",appId:"1:58167961137:web:d07a7cb56569121ad6d710"});var h=m.auth(),d=new m.auth.GoogleAuthProvider,b=m.database(),g=function(){var e=Object(f.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",h.signInWithPopup(d).then(j));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),v=function(){var e=Object(f.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:h.signOut();case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),y=function(){var e=Object(f.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!!h.currentUser);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),x=function(){var e=Object(f.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",h.currentUser.getIdToken(!0));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),w=function(){var e=Object(f.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",h.currentUser);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),j=function(){var e=Object(f.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w();case 2:t=e.sent,b.ref("users/".concat(t.uid)).once("value",(function(e){if(!e.exists()){b.ref("users/".concat(t.uid)).set({color:"white"})}}));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),E=function(){var e=Object(f.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w();case 2:n=e.sent,b.ref("users/".concat(n.uid)).once("value",(function(e){e.exists()?t(e.val()):t({color:"white"})}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),k=function(){var e=Object(f.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w();case 2:n=e.sent,b.ref("/users/".concat(n.uid,"/color/")).set(t);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),O={loginWithGoogle:g,logout:v,loggedIn:y,getUserToken:x,getCurrentUser:w,changeUserColor:k,getUserColor:E},C=function(){var e=function(){var e=Object(f.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.loginWithGoogle();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(){return e.apply(this,arguments)}}();return a.a.createElement("div",{style:{textAlign:"center",marginTop:"30vh"}},a.a.createElement(p.a,{color:"secondary",onClick:e},"Google Login"))},I=(n(127),function(){return a.a.createElement(a.a.Fragment,null,a.a.createElement("h1",null,"Welcome to the react-chat"),a.a.createElement("h3",null,"Login using your google account to start chatting..."),a.a.createElement(C,null))}),S=n(97),U=n(17),W=function(){var e=function(){var e=Object(f.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{O.logout()}catch(t){console.log(t)}case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return a.a.createElement("div",{style:{position:"absolute",top:"2px",right:"10px",zIndex:"1000"}},a.a.createElement(p.a,{color:"secondary",onClick:e},"Logout"))},N=n(198),T=n(199),A=n(210),B=n(209),G=n(202),L=n(98),M=n(91),P=n(92),D=n(99),F=n(96),R=n(93),z=n.n(R),H=function(e){if(e)return z()("",{transports:["websocket"],query:{token:e}})},q=function(e,t,n){t.emit("join",e,n)},J=function(e,t,n){t.emit("leave",e,n)},V=function(e,t,n,r,a){r.emit("message",{chatroomName:e,message:{text:t,color:n}},a)},K=Object(r.createContext)({user:null,users:[]}),Y=function(e){Object(D.a)(n,e);var t=Object(F.a)(n);function n(){var e;Object(M.a)(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).state={user:null,socket:null},e.componentDidMount=function(){h.onAuthStateChanged(function(){var t=Object(f.a)(l.a.mark((function t(n){var r,a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n){t.next=3;break}return e.setState({user:n}),t.abrupt("return");case 3:return t.prev=3,t.next=6,O.getUserToken();case 6:r=t.sent,a=H(r),e.setState({user:n,socket:a}),t.next=15;break;case 11:t.prev=11,t.t0=t.catch(3),e.setState({user:null,socket:null}),console.log(t.t0);case 15:case"end":return t.stop()}}),t,null,[[3,11]])})));return function(e){return t.apply(this,arguments)}}())},e}return Object(P.a)(n,[{key:"render",value:function(){return a.a.createElement(K.Provider,{value:Object(L.a)({},this.state)},this.props.children)}}]),n}(r.Component),$=Object(N.a)((function(e){return{formControl:{margin:e.spacing(1),minWidth:120},selectEmpty:{marginTop:e.spacing(2)}}})),Q=function(e){var t=$(),n=Object(r.useState)([]),c=Object(U.a)(n,2),o=c[0],u=c[1],i=e.room,s=e.changeRoom,p=Object(r.useContext)(K).socket;return Object(r.useEffect)((function(){!function(e,t){e.emit("chatrooms",t)}(p,function(){var e=Object(f.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:u(t),s(t[0]);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[]),a.a.createElement(T.a,{className:t.formControl},a.a.createElement(A.a,{id:"demo-simple-select-label"},"room"),a.a.createElement(B.a,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:i,onChange:function(e){e.preventDefault(),s(e.target.value)}},o.map((function(e){return a.a.createElement(G.a,{value:e,key:e},e)}))))},X=n(167),Z=n(203),_=(n(160),Object(N.a)((function(e){return{root:{display:"flex",justifyContent:"around",alignItems:"center"},inline:{display:"inline"}}}))),ee=function(e){var t=e.users,n=_();return a.a.createElement("div",{className:n.root},a.a.createElement("h4",null,"Users: "),a.a.createElement(Z.a,{max:8},t.map((function(e){return a.a.createElement(X.a,{key:e,alt:e.name,src:e.picture})}))))},te={purple:"#9c27b0",red:"#d32f2f",pink:"#d81b60",indigo:"#3949ab",blue:"#1e88e5",teal:"#009688",cyan:"#0097a7",green:"#43a047",lime:"#cddc39",yellow:"#ffeb3b",orange:"#fb8c00",bluegrey:"#607d8b",white:"#ffffff"},ne=Object(N.a)((function(e){return{formControl:{margin:e.spacing(1),minWidth:120},selectEmpty:{marginTop:e.spacing(2)}}})),re=function(e){var t=e.color,n=e.changeColor,r=ne();return a.a.createElement(T.a,{className:r.formControl},a.a.createElement(A.a,{id:"demo-simple-select-label"},"color"),a.a.createElement(B.a,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:t,style:{color:te[t]},onChange:function(e){e.preventDefault(),n(e.target.value)}},Object.keys(te).map((function(e){return a.a.createElement(G.a,{style:{color:te[e]},value:e,key:e},e)}))))},ae=n(200),ce=n(204),oe=n(211),ue=n(94),ie=n.n(ue),se=Object(N.a)((function(e){return{root:{position:"absolute",bottom:"5px",padding:"2px 4px",display:"flex",alignItems:"center",maxWidth:"600px",width:"96%"},input:{marginLeft:e.spacing(1),flex:1},iconButton:{padding:10}}})),le=function(e){var t=e.room,n=e.userColor,c=se(),o=Object(r.useContext)(K).socket,u=Object(r.useState)(""),i=Object(U.a)(u,2),s=i[0],p=i[1],m=function(){var e=Object(f.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:""!==s&&(V(t,s,n,o),p(""));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return a.a.createElement(ae.a,{component:"form",className:c.root},a.a.createElement(oe.a,{className:c.input,multiline:!0,fullWidth:!0,placeholder:"message, like 'Hello world'",inputProps:{"aria-label":'message, like "hello world"'},onChange:function(e){return p(e.target.value)},value:s}),a.a.createElement(ce.a,{className:c.iconButton,"aria-label":"send",onClick:m},a.a.createElement(ie.a,null)))},fe=n(201),pe=n(165),me=n(205),he=n(212),de=function(e){var t=e.message,n=e.user;e.time;return a.a.createElement(pe.a,{alignItems:"flex-start"},a.a.createElement(me.a,null,a.a.createElement(X.a,{alt:n.name,src:n.picture})),a.a.createElement(he.a,{primary:n.name,secondary:a.a.createElement("span",{style:{color:t.color?te[t.color]:"#ffffff"}},t.text?t.text:t)}))},be=Object(N.a)((function(e){return{root:{height:"100%",maxHeight:"65vh",maxWidth:"600px",overflowY:"scroll"},inline:{display:"inline"}}})),ge=function(e){var t=e.messages,n=be(),c=Object(r.useRef)(null);return Object(r.useEffect)((function(){c.current.scrollIntoView({behavior:"smooth"})}),[t]),a.a.createElement(fe.a,{className:n.root},t.map((function(e){return a.a.createElement(de,{key:e.time,message:e.message,user:e.user,time:e.time})})),a.a.createElement("div",{ref:c}))},ve=function(){var e=Object(r.useContext)(K).socket,t=Object(r.useState)(""),n=Object(U.a)(t,2),c=n[0],o=n[1],u=Object(r.useState)([]),i=Object(U.a)(u,2),s=i[0],p=i[1],m=Object(r.useState)([]),h=Object(U.a)(m,2),d=h[0],b=h[1],g=Object(r.useState)("white"),v=Object(U.a)(g,2),y=v[0],x=v[1];Object(r.useEffect)((function(){e.on("message",(function(e){E(e)})),e.on("users",(function(e){k(e)})),O.getUserColor((function(e){var t=e.color;x(t)})),window.onbeforeunload=function(){J(c,e,(function(){})),e.off()}}),[]);var w=function(){var t=Object(f.a)(l.a.mark((function t(n){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:""===c?j(n):J(c,e,function(){var e=Object(f.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t&&console.log(t),j(n);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),j=function(){var t=Object(f.a)(l.a.mark((function t(n){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:q(n,e,(function(e,t){e&&console.log(e),b(t),o(n)}));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),E=function(e){e.message&&b((function(t){return[].concat(Object(S.a)(t),[e])}))},k=function(e){p(e)};return a.a.createElement("div",{style:{display:"flex",justifyContent:"center"}},a.a.createElement("div",{style:{maxWidth:"600px",width:"100%"}},a.a.createElement(Q,{room:c,changeRoom:w}),a.a.createElement(re,{color:y,changeColor:function(e){x(e),O.changeUserColor(e)}}),a.a.createElement(W,null),a.a.createElement(ee,{users:s}),a.a.createElement(ge,{room:c,messages:d}),a.a.createElement(le,{room:c,userColor:y})))},ye=n(206),xe=n(95),we=n(208);var je=function(){var e=Object(r.useContext)(K).user,t=Object(ye.a)("(prefers-color-scheme: dark)"),n=a.a.useMemo((function(){return Object(xe.a)({palette:{type:t?"dark":"light"},typography:{fontFamily:"hack"}})}),[t]);return a.a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#666666"}},a.a.createElement(u.a,null),a.a.createElement(i.Terminal,{background:"#232537",topbarTitle:e?e.displayName:"react-chat",barHeight:"40px",style:{margin:"2vh",maxWidth:"1200px",width:"100%",height:"96vh",fontFamily:"hack"}},a.a.createElement(we.a,{theme:n},e?a.a.createElement(ve,null):a.a.createElement(I,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(Y,null,a.a.createElement(je,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[112,1,2]]]);
//# sourceMappingURL=main.da52a9e9.chunk.js.map